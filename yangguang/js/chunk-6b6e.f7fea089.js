(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b6e"],{"471c":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("div",{staticClass:"search-con search-con-top"},[a("Select",{staticClass:"search-col",attrs:{placeholder:"请选择搜索字段",clearable:""},on:{"on-clear":t.searchKeyChange,"on-change":t.searchKeyChange},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}},t._l([{key:"is_type",title:"类型"},{key:"is_title",title:"标题"}],function(e){return a("Option",{key:"search-col-"+e.key,attrs:{value:e.key}},[t._v(t._s(e.title))])})),"is_type"===t.searchKey?a("Select",{staticClass:"search-col",attrs:{placeholder:"请选择类型",clearable:""},on:{"on-clear":t.searchKeyChange,"on-change":t.searchKeyChange},model:{value:t.is_type,callback:function(e){t.is_type=e},expression:"is_type"}},t._l(t.isTypeArr,function(e){return a("Option",{key:"search-col-"+e.key,attrs:{value:e.key}},[t._v(t._s(e.title))])})):t._e(),"is_title"===t.searchKey?a("Input",{staticClass:"search-input",attrs:{clearable:"",placeholder:"输入标题关键字搜索"},model:{value:t.is_title,callback:function(e){t.is_title=e},expression:"is_title"}}):t._e(),a("Button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:t.getDataList}},[a("Icon",{attrs:{type:"search"}}),t._v("搜索")],1),t._l(t.permissionBtns,function(e){return 196===e.p_id?a("Button",{staticClass:"add-btn",attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v(t._s(e.p_name))]):t._e()})],2),a("Table",{ref:"tablesMain",attrs:{data:t.tableData,columns:t.columns}}),a("Page",{staticClass:"page",attrs:{total:t.total,"page-size":t.pageSize,"show-sizer":"","show-elevator":"","prev-text":"上一页","next-text":"下一页"},on:{"on-change":t.pageOnChange,"on-page-size-change":t.onPageSizeChange}})],1),a("Modal",{attrs:{width:"800","mask-closable":!1},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a("p",{staticStyle:{color:"#2d8cf0"},attrs:{slot:"header"},slot:"header"},[a("span",[t._v(t._s(t.modalTitle))])]),a("Form",[a("FormItem",[a("label",[t._v("项目名称：")]),a("Input",{attrs:{readonly:t.isView,placeholder:"请填写项目名称"},model:{value:t.cpName,callback:function(e){t.cpName=e},expression:"cpName"}})],1),a("FormItem",[a("label",[t._v("所属部门：")]),a("Select",{attrs:{disabled:t.isView,placeholder:"请填写现部门"},model:{value:t.departId,callback:function(e){t.departId=e},expression:"departId"}},t._l(t.allDepart,function(e){return a("Option",{attrs:{value:e.depart_id}},[t._v(t._s(e.depart_name))])}))],1),a("FormItem",[a("label",[t._v("负责人：")]),a("Select",{attrs:{disabled:t.isView,placeholder:"请选择项目负责人"},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}},t._l(t.allUsers,function(e){return a("Option",{key:"search-col-"+e.username,attrs:{value:e.username}},[t._v(t._s(e.username))])}))],1)],1),t.isView&&!t.isEdit?a("label",[t._v("附件：")]):t._e(),a("Upload",{attrs:{action:"http://47.106.109.254:8090/m/documentFile/uploadDocument.do",headers:t.header,multiple:"",name:"document",data:{dfNo:t.editId,dfType:"coor_project"},"on-success":t.handleSuccess,"on-remove":t.handleRemove,"on-preview":t.showPreview,"before-upload":t.handleBeforeUpload,"on-format-error":t.handleFormatError,"default-file-list":t.fileList}},[!t.isView&&t.isEdit?a("Button",{attrs:{id:"upLoadImg",icon:"ios-cloud-upload-outline"}},[t._v("附件上传")]):t._e()],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[t.isView||t.isEdit?t._e():a("Button",{attrs:{type:"info",size:"large"},on:{click:t.addEntity}},[t._v("保存")]),t.isEdit?a("Button",{attrs:{type:"info",size:"large"},on:{click:t.editEntity}},[t._v("修改")]):t._e()],1)],1)],1)},s=[],n=(a("ac4d"),a("8a81"),a("ac6a"),a("cadf"),a("551c"),a("097d"),a("66df")),o=a("c276"),l=a("88ec"),r={name:"coorProject_page",components:{},data:function(){var t=this;return{cpName:"",fileList:[],allDepart:[],allUsers:[],departId:"",userName:"",columns:[{title:"序号",align:"center",key:"cp_id",sortable:!0},{title:"项目名称",align:"center",key:"cp_name"},{title:"所属部门",align:"center",key:"depart_name"},{title:"项目负责人",align:"center",key:"username"},{title:"操作",key:"handle",align:"center",render:function(e,a){for(var i=[],s=0;s<t.handleBtns.length;s++){t.handleBtns[s];197===t.handleBtns[s].p_id?i.push(e("Button",{props:{type:"primary",size:"small",disabled:5===a.row.data_level},style:{margin:"2px"},on:{click:function(){t.showOneEntity(a.row.cp_id),t.showModal=!0,t.modalTitle="编辑",t.isView=!1,t.isEdit=!0,t.editId=a.row.cp_id}}},"编辑")):198===t.handleBtns[s].p_id?i.push(e("Button",{props:{type:"info",size:"small"},style:{margin:"2px"},on:{click:function(){t.showOneEntity(a.row.cp_id),t.showModal=!0,t.modalTitle="查看",t.isView=!0,t.isEdit=!1}}},"查看")):199===t.handleBtns[s].p_id?i.push(e("Button",{props:{type:"error",size:"small",disabled:5===a.row.data_level},style:{margin:"2px"},on:{click:function(){t.deleteEntity(a.row.cp_id)}}},"删除")):200===t.handleBtns[s].p_id&&i.push(e("Button",{props:{type:"warning",size:"small",disabled:1===a.row.data_level},style:{margin:"2px"},on:{click:function(){t.restoreEntity(a.row.cp_id)}}},"恢复"))}return e("div",i)}}],tableData:[],searchValue:"",searchKey:"",showModal:!1,modalTitle:"添加",header:{},permissionBtns:[],handleBtns:[],isView:!1,isEdit:!1,total:0,pageNum:1,pageSize:20,getListPath:"",showOnePath:"",editId:"",addOnePath:"",editOnePath:"",deleteOnePath:"",restoreOnePath:"",isTypeArr:[]}},methods:{handleAdd:function(){this.showModal=!0,this.isView=!1,this.isEdit=!1,this.modalTitle="添加"},getDataList:function(){var t=this;n["a"].request({url:t.getListPath,data:{pageNum:t.pageNum,pageSize:t.pageSize},method:"post"}).then(function(e){if(200===e.status){t.tableData=[];for(var a=0;a<e.data.content.list.length;a++)t.tableData.push(e.data.content.list[a])}else t.$Notice.error({title:e.data.msg})})},addEntity:function(){var t=this;n["a"].request({url:t.addOnePath,data:{cpName:t.cpName},method:"post"}).then(function(e){200===e.data.code?(t.getDataList(),t.showModal=!1,t.$Notice.success({title:"添加成功"})):t.$Notice.error({title:e.data.msg})})},editEntity:function(){var t=this;n["a"].request({url:t.editOnePath,data:{cpId:t.editId,cpName:t.cpName},method:"post"}).then(function(e){200===e.data.code?(t.getDataList(),t.showModal=!1,t.$Notice.success({title:"编辑成功"})):t.$Notice.error({title:e.data.msg})})},showOneEntity:function(t){var e=this;n["a"].request({url:e.showOnePath,data:{entityId:t},method:"post"}).then(function(t){for(var a in console.log(t),e.cpName=t.data.content.cp_name,e.departId=t.data.content.depart_id,e.userName=t.data.content.username,e.fileList=[],t.data.content.files)e.fileList.push({name:t.data.content.files[a].df_name,url:"http://47.106.109.254:8090/"+t.data.content.files[a].df_url})})},deleteEntity:function(t){var e=this;isView?e.$Notice.warning({title:"查看中不允许删除"}):this.$Modal.confirm({title:"提示",content:"确认删除？",onOk:function(){n["a"].request({url:e.deleteOnePath,data:{entityId:t},method:"post"}).then(function(t){200===t.data.code?(e.getDataList(),e.$Notice.success({title:"删除成功"})):e.$Notice.error({title:t.data.msg})})}})},restoreEntity:function(t){var e=this;e.$Modal.confirm({title:"提示",content:"确认恢复？",onOk:function(){n["a"].request({url:e.restoreOnePath,data:{entityId:t},method:"post"}).then(function(t){200===t.data.code?(e.getDataList(),e.$Notice.success({title:"恢复成功"})):e.$Notice.error({title:t.data.msg})})}})},handleSuccess:function(t,e){this.$Spin.hide(),this.$Notice.success({title:"附件上传成功"})},handleRemove:function(t,e){var a=this;a.isView?a.$Notice.Warring({title:"查看中不允许删除"}):n["a"].request({url:"m/documentFile/removeDocument.do",method:"post",data:{documentId:t.uid}}).then(function(t){200===t.data.code?a.$Notice.success({title:"删除成功"}):a.$Notice.error({title:t.data.msg})})},showPreview:function(t){window.open(t.url)},handleFormatError:function(){this.$Spin.hide()},handleBeforeUpload:function(){this.$Spin.show({render:function(t){return t("div",[t("Icon",{class:"demo-spin-icon-load",props:{type:"ios-loading",size:18}}),t("div","upLoading")])}})},pageOnChange:function(t){this.pageNum=t,this.getDataList()},onPageSizeChange:function(t){this.pageNum=1,this.pageSize=t,this.getDataList()},searchKeyChange:function(){this.me_title="",this.me_name=""},getPermissionBtns:function(){this.permissionBtns=[];var t=!0,e=!1,a=void 0;try{for(var i,s=l["a"].permission[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var n=i.value;n.p_fid===this.$route.meta.id&&(this.permissionBtns.push(n),195===n.p_id&&(this.getListPath=n.p_path),196===n.p_id&&(this.addOnePath=n.p_path),197==n.p_id&&(this.editOnePath=n.p_path),198===n.p_id&&(this.showOnePath=n.p_path),199===n.p_id&&(this.deleteOnePath=n.p_path),200===n.p_id&&(this.restoreOnePath=n.p_path),197!==n.p_id&&198!==n.p_id&&199!==n.p_id&&200!==n.p_id||this.handleBtns.push(n))}}catch(t){e=!0,a=t}finally{try{t||null==s.return||s.return()}finally{if(e)throw a}}},attachmentUpload:function(){},getAllDepart:function(){var t=this;n["a"].request({url:"/admin/settings/depart/showEntity.do",data:{dataLevel:1},method:"post"}).then(function(e){for(var a in e.data.content.list)t.allDepart.push(e.data.content.list[a])})},getAllUsers:function(){var t=this;n["a"].request({url:"/m/getAllUsers.do",data:{},method:"post"}).then(function(e){t.allUsers=e.data.content})}},mounted:function(){this.getPermissionBtns(),this.getDataList(),this.getAllDepart(),this.getAllUsers(),this.header={authorization:Object(o["i"])()}},watch:{showModal:function(t){t||(this.cpName="",this.departId="",this.userName="",this.fileList=[],this.isEdit=!1,this.isView=!1)}}},d=r,c=(a("955b"),a("2877")),h=Object(c["a"])(d,i,s,!1,null,null,null);h.options.__file="coorProject.vue";e["default"]=h.exports},"955b":function(t,e,a){"use strict";var i=a("d812"),s=a.n(i);s.a},d812:function(t,e,a){}}]);