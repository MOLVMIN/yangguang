(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c11"],{"1b0b":function(e,t,a){},2051:function(e,t,a){"use strict";var s=a("1b0b"),r=a.n(s);r.a},cb10:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",[a("div",{staticClass:"search-con search-con-top"},[a("Select",{staticClass:"search-col",attrs:{placeholder:"请选择搜索字段",clearable:""},on:{"on-clear":e.searchKeyChange,"on-change":e.searchKeyChange},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}},e._l([{key:"user_name",title:"人员名称"},{key:"user_type",title:"人员类型"},{key:"role_name",title:"人员角色"}],function(t){return a("Option",{key:"search-col-"+t.key,attrs:{value:t.key}},[e._v(e._s(t.title))])})),"user_name"===e.searchKey?a("Input",{staticClass:"search-input search-con",attrs:{clearable:"",placeholder:"请输入人员名称关键字搜索"},model:{value:e.user_name,callback:function(t){e.user_name=t},expression:"user_name"}}):e._e(),"user_type"===e.searchKey?a("Select",{staticClass:"search-col search-con",staticStyle:{"margin-left":"2px"},attrs:{clearable:"",placeholder:"请选择人员类型"},model:{value:e.user_type,callback:function(t){e.user_type=t},expression:"user_type"}},e._l(e.userTypeList,function(t){return a("Option",{key:"search-col-"+t.label,attrs:{value:t.key}},[e._v(e._s(t.label))])})):e._e(),"role_name"===e.searchKey?a("Select",{staticClass:"search-col",staticStyle:{"margin-left":"2px"},attrs:{clearable:"",placeholder:"请选择角色类型"},model:{value:e.role_name,callback:function(t){e.role_name=t},expression:"role_name"}},e._l(e.roleList,function(t){return a("Option",{key:"search-col-"+t.role_name,attrs:{value:t.role_name}},[e._v(e._s(t.role_name))])})):e._e(),a("Button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:e.getUserList}},[e._v("搜索")]),e._l(e.permissionBtns,function(t){return 23===t.p_id?a("Button",{staticClass:"add-btn",attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v(e._s(t.p_name))]):e._e()}),a("Button",{staticClass:"add-btn",staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:e.allotEvent}},[e._v("用户权限分配")])],2),a("Table",{ref:"tablesMain",attrs:{data:e.tableData,columns:e.columns}}),a("Page",{staticClass:"page",attrs:{total:e.total,"page-size":e.pageSize,"show-sizer":"","show-elevator":"","prev-text":"上一页","next-text":"下一页"},on:{"on-change":e.pageOnChange,"on-page-size-change":e.onPageSizeChange}})],1),a("Modal",{attrs:{width:"800","mask-closable":!1},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("p",{staticStyle:{color:"#2d8cf0"},attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(e.modalTitle))])]),a("Form",[a("FormItem",[a("label",[e._v("人员名称：")]),a("Input",{attrs:{readonly:e.isView,placeholder:"请输入人员名称"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}})],1),a("FormItem",[a("label",[e._v("人员类型：")]),a("Select",{attrs:{disabled:e.isView},model:{value:e.userType,callback:function(t){e.userType=t},expression:"userType"}},e._l(e.userTypeList,function(t){return a("Option",{key:"search-col-"+t.key,attrs:{value:t.key}},[e._v(e._s(t.label))])}))],1),a("FormItem",[a("label",[e._v("所属部门：")]),a("Select",{attrs:{disabled:e.isView},model:{value:e.userDepart,callback:function(t){e.userDepart=t},expression:"userDepart"}},e._l(e.userDepartList,function(t){return a("Option",{attrs:{value:t.key}},[e._v(e._s(t.label))])}))],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[e.isView||e.isEdit?e._e():a("Button",{attrs:{type:"info",size:"large"},on:{click:e.addUser}},[e._v("保存")]),e.isEdit?a("Button",{attrs:{type:"success",size:"large"},on:{click:e.editUser}},[e._v("修改")]):e._e()],1)],1),a("Modal",{attrs:{width:"400","mask-closable":!1},model:{value:e.showAllotModal,callback:function(t){e.showAllotModal=t},expression:"showAllotModal"}},[a("p",{staticStyle:{color:"#2d8cf0"},attrs:{slot:"header"},slot:"header"},[a("span",[e._v("权限分配")])]),a("Form",[a("FormItem",[a("label",[e._v("用户名称：")]),a("Select",{attrs:{clearable:""},on:{"on-change":e.getAllotEntity},model:{value:e.allotId,callback:function(t){e.allotId=t},expression:"allotId"}},e._l(e.tableData,function(t){return a("Option",{attrs:{value:t.id}},[e._v(e._s(t.username))])}))],1),a("Tree",{attrs:{data:e.roleIdArray,multiple:""},on:{"on-select-change":e.onCheckSelect}})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"info",size:"large"},on:{click:e.allotPermission}},[e._v("保存")])],1)],1)],1)},r=[],i=(a("7f7f"),a("ac4d"),a("8a81"),a("ac6a"),a("cadf"),a("551c"),a("097d"),a("66df")),o=a("88ec"),n=a("c276"),l={name:"work",data:function(){var e=this;return{user_name:"",user_type:"",role_name:"",roleList:[],columns:[{title:"编号",align:"center",key:"id",sortable:!0},{title:"人员名称",align:"center",key:"username"},{title:"所属部门",align:"center",key:"depart_name"},{title:"人员类型",align:"center",key:"user_type",render:function(e,t){return 0===t.row.user_type?e("div","超级管理员"):1===t.row.user_type?e("div","普通管理员"):2===t.row.user_type?e("div","普通用户"):void 0}},{title:"人员角色",align:"center",key:"roleNames"},{title:"操作",key:"handle",align:"center",render:function(t,a){for(var s=[],r=function(){var r=e.handleBtns[i];24===r.p_id?s.push(t("Button",{props:{type:"primary",size:"small",disabled:5===a.row.data_level},style:{margin:"2px"},on:{click:function(){e.editId=a.row.id,e.showOneUser(e.showOneWorkPath,a.row.id),e.showModal=!0,e.modalTitle="人员信息修改",e.isView=!1,e.isEdit=!0}}},"修改")):25===r.p_id?s.push(t("Button",{props:{type:"info",size:"small"},style:{margin:"2px"},on:{click:function(){e.showOneUser(r.p_path,a.row.id),e.showModal=!0,e.modalTitle="人员信息查看",e.isView=!0,e.isEdit=!1}}},"查看")):26===r.p_id?s.push(t("Button",{props:{type:"error",size:"small",disabled:5===a.row.data_level},style:{margin:"2px"},on:{click:function(){e.deleteUser(r.p_path,a.row.id)}}},"删除")):27===r.p_id&&s.push(t("Button",{props:{type:"warning",size:"small",disabled:1===a.row.data_level},style:{margin:"2px"},on:{click:function(){e.restoreUser(r.p_path,a.row.id)}}},"恢复"))},i=0;i<e.handleBtns.length;i++)r();return t("div",s)}}],tableData:[],searchValue:"",searchKey:"",userName:"",userPassword:"",userType:"",userTypeList:[{key:0,label:"超级管理员"},{key:1,label:"普通管理员"},{key:2,label:"普通用户"}],userDepart:0,userDepartList:[],showModal:!1,showAllotModal:!1,departFid:"",departFidList:[],modalTitle:"添加人员信息",isView:!1,isEdit:!1,editId:"",permissionBtns:[],handleBtns:[],roleIds:[],listStyle:{width:"350px",height:"300px"},transferTitles:["待分配权限","已分配权限"],allotId:"",allotIdList:[],total:0,pageSize:10,pageNum:1,getListPath:"",showOneWorkPath:"",header:{},avator:"",departPageSize:10,departPageNum:1,roleIdArray:[]}},methods:{handleAdd:function(){this.showModal=!0,this.isView=!1},handleClear:function(e){""===e.target.value&&(this.insideTableData=this.value)},getUserList:function(){var e=this,t=this;i["a"].request({url:t.getListPath,data:{pageNum:t.pageNum,pageSize:t.pageSize,name:t.user_name,roleName:t.role_name,type:t.user_type},method:"post"}).then(function(a){if(200===a.data.code){e.tableData=[];for(var s=0;s<a.data.content.list.length;s++)t.tableData.push(a.data.content.list[s])}else t.$Notice.error({title:a.data.msg})})},getDepartList:function(){var e=this;i["a"].request({url:"admin/settings/depart/showEntity.do",data:{pageNum:e.departPageNum,pageSize:e.departPageSize},method:"post"}).then(function(t){if(200===t.data.code){e.userDepartList=[];for(var a=0;a<t.data.content.list.length;a++)5!==t.data.content.list[a].data_level&&e.userDepartList.push({key:t.data.content.list[a].depart_id,label:t.data.content.list[a].depart_name})}else e.$Notice.error({title:t.data.msg})})},getAllotEntity:function(){var e=this,t=this;i["a"].request({url:"admin/settings/worker/allotEntity.do?userId="+t.allotId,data:{},method:"get"}).then(function(a){for(var s in e.roleIdArray=[],a.data.content.roles)for(var r in t.roleIdArray.push({roleId:a.data.content.roles[s].role_id,title:a.data.content.roles[s].role_name,selected:!1}),a.data.content.userRoles)a.data.content.userRoles[r].role_id===a.data.content.roles[s].role_id&&(e.roleIdArray[s].selected=!0)})},addUser:function(){var e=this;i["a"].request({url:"admin/settings/worker/addEntity.do",data:{username:e.userName,userType:e.userType,userDepart:e.userDepart},method:"post"}).then(function(t){200===t.data.code?(e.getUserList(),e.showModal=!1,e.$Notice.success({title:"人员添加成功"})):e.$Notice.error({title:t.data.msg})})},editUser:function(){var e=this;i["a"].request({url:"admin/settings/worker/editEntity.do",data:{id:e.editId,username:e.userName,userType:e.userType,userDepart:e.userDepart},method:"post"}).then(function(t){200==t.data.code?(e.getUserList(),e.$Notice.success({title:"人员信息修改成功"}),e.showModal=!1):e.$Notice.error({title:t.data.msg})})},deleteUser:function(e,t){var a=this;this.$Modal.confirm({title:"提示",content:"确认删除人员信息？",onOk:function(){var s=this;i["a"].request({url:e,data:{entityId:t},method:"post"}).then(function(e){200==e.data.code?(s.$Notice.success({title:"人员信息删除成功"}),a.getUserList()):s.$Notice.error({title:e.data.msg})})}})},showOneUser:function(e,t){var a=this;i["a"].request({url:e,data:{entityId:t},method:"post"}).then(function(e){200===e.status?(a.userName=e.data.content.username,a.userType=parseInt(e.data.content.user_type),a.userDepart=parseInt(e.data.content.user_depart)):a.$Notice.error({title:e.data.msg})})},restoreUser:function(e,t){var a=this;this.$Modal.confirm({title:"提示",content:"确认恢复人员信息？",onOk:function(){var s=this;i["a"].request({url:e,data:{entityId:t},method:"post"}).then(function(e){200==e.data.code?(s.$Notice.success({title:"人员信息恢复成功"}),a.getUserList()):s.$Notice.error({title:e.data.msg})})}})},getPermissionBtns:function(){this.permissionBtns=[];var e=!0,t=!1,a=void 0;try{for(var s,r=o["a"].permission[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){var i=s.value;i.p_fid===this.$route.meta.id&&(this.permissionBtns.push(i),22===i.p_id&&(this.getListPath=i.p_path),25===i.p_id&&(this.showOneWorkPath=i.p_path),24!==i.p_id&&25!==i.p_id&&26!==i.p_id&&27!==i.p_id||this.handleBtns.push(i))}}catch(e){t=!0,a=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}},allotEvent:function(){this.showAllotModal=!0},allotPermission:function(){var e=this;e.$Modal.confirm({title:"提示",content:"确认分配权限？",onOk:function(){i["a"].request({url:"admin/settings/worker/allotEntity.do",data:{userId:e.allotId,roleIds:e.allotIdList.join(",")},method:"post"}).then(function(t){200===t.status?(e.showAllotModal=!1,e.getUserList(),e.allotId="",e.$Notice.success({title:"用户权限分配成功"})):e.$Notice.error({title:t.data.msg})})}})},render1:function(e){return e.label},transferChange:function(e,t,a){this.roleIds=e,console.log(this.roleIds)},pageOnChange:function(e){this.pageNum=e,this.getDepartList()},onPageSizeChange:function(e){this.pageNum=1,this.pageSize=e,this.getDepartList()},handleView:function(e){this.imgName=e,this.visible=!0},handleRemove:function(e){var t=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(t.indexOf(e),1)},handleSuccess:function(e,t){console.log("http://47.106.109.254:8090"+e.content),this.avator="http://47.106.109.254:8090"+e.content},handleFormatError:function(e){this.$Notice.warning({title:"The file format is incorrect",desc:"File format of "+e.name+" is incorrect, please select jpg or png."})},handleMaxSize:function(e){this.$Notice.warning({title:"Exceeding file size limit",desc:"File  "+e.name+" is too large, no more than 2M."})},onCheckSelect:function(e){for(var t in this.allotIdList=[],e)this.allotIdList.push(e[t].roleId)},getRoleList:function(){var e=this;i["a"].request({url:"admin/settings/role/showEntity.do",data:{},method:"post"}).then(function(t){e.roleList=t.data.content.list})},searchKeyChange:function(){this.userName="",this.userType="",this.roleNames=""}},mounted:function(){this.getPermissionBtns(),this.getUserList(),this.getDepartList(),this.getRoleList(),this.header={authorization:Object(n["i"])()}},watch:{showModal:function(e){e||(this.userName="",this.userType="",this.userDepart="",this.isView=!1,this.isEdit=!1)}}},c=l,d=(a("2051"),a("2877")),u=Object(d["a"])(c,s,r,!1,null,null,null);u.options.__file="work.vue";t["default"]=u.exports}}]);